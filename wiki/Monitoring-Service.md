# Служба мониторинга

## Архитектура службы

Служба мониторинга (monitoring_service.py) является ядром системы PatchWatch. Она реализует:

- Мониторинг файловой системы через библиотеку watchdog
- Обработку событий файловой системы
- Интеграцию с GitLab API
- Логирование операций

## Обработка событий

Служба мониторинга обрабатывает три основных типа событий:

### Создание файлов
1. Обнаружение события создания файла
2. Анализ пути файла
3. Чтение содержимого файла
4. Загрузка файла в GitLab
5. Создание коммита
6. Локальное резервирование
7. Запись в журнал

### Изменение файлов
1. Обнаружение события изменения файла
2. Анализ пути файла
3. Чтение нового содержимого файла
4. Обновление файла в GitLab
5. Создание коммита
6. Обновление локальной резервной копии
7. Запись в журнал

### Удаление файлов
1. Обнаружение события удаления файла
2. Анализ пути удаленного файла
3. Проверка существования файла в GitLab
4. Удаление файла из GitLab
5. Создание коммита удаления
6. Удаление локальной резервной копии
7. Запись в журнал

## Архитектурные паттерны

### Паттерн наблюдателя
События файловой системы отслеживаются через обработчики `watchdog`, что позволяет реагировать на изменения в реальном времени.

### Паттерн одиночки
Конфигурация загружается один раз и используется во всех модулях, обеспечивая согласованность настроек.

### Разделение ответственности
Разные компоненты отвечают за отдельные аспекты функциональности:
- monitoring_service.py: основная логика мониторинга и синхронизации
- web_interface.py: веб-интерфейс и API
- autonomous_monitor.py: автономный режим работы